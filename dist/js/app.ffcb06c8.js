(function(t){function e(e){for(var o,i,s=e[0],c=e[1],u=e[2],l=0,f=[];l<s.length;l++)i=s[l],r[i]&&f.push(r[i][0]),r[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);d&&d(e);while(f.length)f.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(o=!1)}o&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var o={},r={app:0},a=[];function i(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=o,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var d=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"013e":function(t,e,n){"use strict";var o=n("e2ef"),r=n.n(o);r.a},"034f":function(t,e,n){"use strict";var o=n("64a9"),r=n.n(o);r.a},"24fe":function(t,e,n){"use strict";var o=n("bade"),r=n.n(o);r.a},"28b7":function(t,e,n){},"2b46":function(t,e,n){},"4f46":function(t,e,n){"use strict";var o=n("a57a"),r=n.n(o);r.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var o=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},a=[],i=(n("034f"),n("2877")),s={},c=Object(i["a"])(s,r,a,!1,null,null,null);c.options.__file="App.vue";var u=c.exports,d=n("8c4f"),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home container"},[t._m(0),n("div",{staticClass:"item"},[n("HomeMenu")],1)])},f=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"item"},[n("h2",{staticClass:"title"},[t._v("Koup")])])}],p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home-menu container"},[n("div",{staticClass:"item"},[n("button",{on:{click:t.createGame}},[t._v("Create Game")])]),n("div",{staticClass:"item"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.roomId,expression:"roomId"}],domProps:{value:t.roomId},on:{input:function(e){e.target.composing||(t.roomId=e.target.value)}}})]),n("div",{staticClass:"item"},[n("button",{on:{click:t.joinGame}},[t._v("Join Game")])])])},m=[],h=n("8785"),v=n("9530"),C=n.n(v);function b(){var t=Object(h["a"])(["mutation ($input: RoomActionInput!) {\n            joinChecker(input: $input) {\n              room {\n                key\n              }\n            }\n          }"]);return b=function(){return t},t}function _(){var t=Object(h["a"])(["mutation ($input: CreateRoomInput!) {\n          createRoom(input: $input) {\n            room {\n              key\n            }\n          }\n        }"]);return _=function(){return t},t}var y={data:function(){return{roomId:""}},methods:{createGame:function(){var t=this;this.$apollo.mutate({mutation:C()(_()),variables:{input:{}}}).then(function(e){t.roomId=parseInt(e.data.createRoom.room.key,10),t.joinGame()}).catch(function(t){console.error(t),alert("An error has occurred.")})},joinGame:function(){var t=this;0!=this.roomId.length?this.$apollo.mutate({mutation:C()(b()),variables:{input:{roomKey:this.roomId}}}).then(function(e){t.$router.push({name:"room",params:{roomId:t.roomId}})}).catch(function(t){console.error(t),alert("An error has occurred.")}):alert("no room id")}}},A=y,g=(n("915a"),Object(i["a"])(A,p,m,!1,null,"5b6c453a",null));g.options.__file="HomeMenu.vue";var I=g.exports,M={components:{HomeMenu:I}},$=M,O=(n("24fe"),Object(i["a"])($,l,f,!1,null,"42e2d2b4",null));O.options.__file="Home.vue";var w=O.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"room"},[n(t.currentRoomComponent,{tag:"component",attrs:{roomId:t.roomId,userId:t.userId},on:{"change-room-component":t.changeRoomComponent}})],1)},j=[],S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"room-lobby"},[t._v("\n  Room Lobby with roomIdInt "+t._s(t.roomIdInt)+" and userId "+t._s(t.userId)+".\n  Number of players: "+t._s(t.numOfPlayers)+".\n  Room State: "+t._s(t.roomState)+"\n  "),n("button",{on:{click:t.sendStartGame}},[t._v("Start Game")])])},R=[];n("c5f6"),n("7cdf");function G(){var t=Object(h["a"])(["mutation ($input: RoomActionInput!) {\n          startRoom(input: $input) {\n            room {\n              key\n            }\n          }\n        }"]);return G=function(){return t},t}function E(){var t=Object(h["a"])(["query ($id: ID!) {\n        room(id: $id) {\n          state\n          players {\n            edges {\n              node {\n                id\n              }\n            }\n          }\n        }\n      }"]);return E=function(){return t},t}var P={props:["roomId","userId"],apollo:{room:{query:C()(E()),variables:function(){return{id:this.roomIdInt}},result:function(t){this.numOfPlayers=t.data.room.players.edges.length,this.roomState=t.data.room.state},pollInterval:1e3}},data:function(){return{roomIdInt:Number.isInteger(this.roomId)?this.roomId:parseInt(this.roomId,10),numOfPlayers:0,roomState:1}},methods:{sendStartGame:function(){this.$apollo.mutate({mutation:C()(G()),variables:{input:{roomKey:this.roomIdInt}}}).catch(function(t){console.error(t),alert("An error has occurred.")})},startGame:function(){this.$emit("change-room-component","RoomGame")}},watch:{roomState:function(t,e){2==t&&this.startGame()}}},x=P,N=(n("013e"),Object(i["a"])(x,S,R,!1,null,"7a0ecf8b",null));N.options.__file="RoomLobby.vue";var L=N.exports,T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"room-game"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("GameActions",{attrs:{coins:t.coins,cardsMode:t.cardsMode},on:{"set-coins":t.setCoins,"set-mode":t.setMode}})],1),n("div",{staticClass:"col"},[n("GameCards",{attrs:{cards:t.cards,cardsMode:t.cardsMode},on:{"clicked-card":t.clickedCard}})],1)])])},q=[],U=(n("7514"),n("55dd"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"game-actions"},[n("GameActionsCoins",{staticClass:"action",attrs:{coins:t.coins},on:{"set-coins":t.setCoins}}),n("GameActionsCards",{staticClass:"action",attrs:{cardsMode:t.cardsMode},on:{"set-mode":t.setMode}})],1)}),D=[],H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"game-actions-coins"},[n("div",{staticClass:"row"},t._l(t.addCoinAmounts,function(e){return n("button",{key:e,staticClass:"coin-button",attrs:{disabled:!t.canAddCoins(e)},on:{click:function(n){t.addCoins(e)}}},[t._v("\n        +"+t._s(e)+"\n    ")])}),0),n("div",{staticClass:"row"},[t._v("\n    Coins: "+t._s(t.coins)+"\n  ")]),n("div",{staticClass:"row"},t._l(t.removeCoinAmounts,function(e){return n("button",{key:e,staticClass:"coin-button",attrs:{disabled:!t.canRemoveCoins(e)},on:{click:function(n){t.removeCoins(e)}}},[t._v("\n        -"+t._s(e)+"\n    ")])}),0)])},J=[],V={props:["coins"],data:function(){return{addCoinAmounts:[1,2,3],removeCoinAmounts:[2,3,7]}},methods:{canAddCoins:function(t){return this.coins<10},canRemoveCoins:function(t){return 2==t||(3==t?this.coins>=3&&this.coins<10:this.coins>=t)},addCoins:function(t){this.canAddCoins(t)&&this.$emit("set-coins",this.coins+t)},removeCoins:function(t){if(this.canRemoveCoins(t)){var e=this.coins-t;this.$emit("set-coins",e>=0?e:0)}}}},K=V,B=(n("eb9f"),Object(i["a"])(K,H,J,!1,null,"10e81c69",null));B.options.__file="GameActionsCoins.vue";var Q=B.exports,W=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"game-actions-cards"},[n("button",{staticClass:"action-btn",on:{click:function(e){t.setMode("swap")}}},[t._v("\n    Swap"),"swap"==t.cardsMode?n("span",[t._v("ing")]):t._e()]),n("button",{staticClass:"action-btn",on:{click:function(e){t.setMode("kill")}}},[t._v("\n    Kill"),"kill"==t.cardsMode?n("span",[t._v("ing")]):t._e()]),n("button",{staticClass:"action-btn",on:{click:function(e){t.setMode("reveal")}}},[t._v("\n    Reveal"),"reveal"==t.cardsMode?n("span",[t._v("ing")]):t._e()])])},z=[],F={props:["cardsMode"],methods:{setMode:function(t){this.$emit("set-mode",t)}}},X=F,Y=(n("6b64"),Object(i["a"])(X,W,z,!1,null,"890cc712",null));Y.options.__file="GameActionsCards.vue";var Z=Y.exports,tt={components:{GameActionsCoins:Q,GameActionsCards:Z},props:["coins","cardsMode"],data:function(){return{}},methods:{setCoins:function(t){this.$emit("set-coins",t)},setMode:function(t){this.$emit("set-mode",t)}}},et=tt,nt=(n("b7f6"),Object(i["a"])(et,U,D,!1,null,"b32c6818",null));nt.options.__file="GameActions.vue";var ot=nt.exports,rt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"game-cards"},t._l(t.cards,function(e){return n("GameCardsCard",{key:e.id,staticClass:"card",attrs:{card:e},on:{"clicked-card":t.clickedCard}})}),1)},at=[],it=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"game-cards-card",on:{click:function(e){t.clickedCard(t.card.id)}}},[t.card.hidden&&t.card.alive?n("p",[t._v("HIDDEN")]):n("p",[t._v(t._s(t.card.type))]),t.card.selected?n("p",[t._v("SELECTED")]):t._e(),t.card.alive?t._e():n("p",[t._v("DEAD")])])},st=[],ct={props:["card"],methods:{clickedCard:function(t){this.$emit("clicked-card",t)}}},ut=ct,dt=(n("cf79"),Object(i["a"])(ut,it,st,!1,null,null,null));dt.options.__file="GameCardsCard.vue";var lt=dt.exports,ft={components:{GameCardsCard:lt},props:["cards","cardsMode"],methods:{clickedCard:function(t){this.$emit("clicked-card",t)}}},pt=ft,mt=(n("ab64"),Object(i["a"])(pt,rt,at,!1,null,"e2c8c5f4",null));mt.options.__file="GameCards.vue";var ht=mt.exports;function vt(){var t=Object(h["a"])(["mutation ($input: PutCardsInput!) {\n                  revealCard(input: $input) {\n                    player {\n                      hand\n                    }\n                  }\n                }"]);return vt=function(){return t},t}function Ct(){var t=Object(h["a"])(["mutation ($input: PutCardsInput!) {\n                swapEnd(input: $input) {\n                  player {\n                    id\n                  }\n                }\n              }"]);return Ct=function(){return t},t}function bt(){var t=Object(h["a"])(["mutation ($input: GetCardsInput!) {\n              swapStart(input: $input) {\n                player {\n                  hand\n                }\n              }\n            }"]);return bt=function(){return t},t}function _t(){var t=Object(h["a"])(["query ($id: ID!) {\n        player(id: $id) {\n          hand\n        }\n      }"]);return _t=function(){return t},t}function yt(){var t=Object(h["a"])(["query {\n        allCards {\n          edges {\n            node {\n              dbId\n              type\n            }\n          }\n        }\n      }"]);return yt=function(){return t},t}var At={components:{GameActions:ot,GameCards:ht},props:["roomId","userId"],apollo:{allCards:{query:C()(yt()),manual:!0,result:function(t){for(var e=t.data.allCards.edges,n=0;n<e.length;++n){var o=e[n].node;this.cardsMap[o.dbId]=o.type}console.log(this.cardsMap),this.$apollo.queries.player.skip=!1,this.$apollo.queries.player.refetch()}},player:{query:C()(_t()),variables:function(){return{id:this.userId}},manual:!0,skip:!0,result:function(t){var e=t.data.player.hand,n=this.parseCards(e,{hidden:!0,alive:!0,selected:!1,owned:!0});this.cards=n}}},data:function(){return{cards:[],coins:0,cardsMode:"display",cardsMap:{}}},computed:{selectedCap:function(){return"display"==this.cardsMode?0:"swap"==this.cardsMode?this.cards.filter(function(t){return t.alive&&t.owned}).length:"kill"==this.cardsMode?1:"reveal"==this.cardsMode?1:void alert("An error has occurred.")},currentlySelectedAmount:function(){return this.cards.filter(function(t){return t.selected}).length}},created:function(){},methods:{parseCards:function(t,e){for(var n=[],o=0;o<t.length;++o){var r=JSON.parse(JSON.stringify(e)),a=t[o],i=this.cardsMap[a];r.id=a,r.type=i,n.push(r)}return n},setCoins:function(t){this.coins=t},setMode:function(t){var e=this;if("display"==this.cardsMode)"swap"==t?this.$apollo.mutate({mutation:C()(bt()),variables:{input:{id:this.userId,numCards:2}}}).then(function(n){var o=n.data.swapStart.player.hand.filter(function(t){return e.cards.reduce(function(e,n){return e&&t!=n.id},!0)}),r=e.parseCards(o,{hidden:!1,alive:!0,selected:!1,owned:!1});e.cards=e.cards.concat(r),e.cardsMode=t,e.unhideAll()}).catch(function(t){console.error(t),alert("An error has occurred.")}):"kill"==t?(this.unhideAll(),this.cardsMode=t):"reveal"==t?(this.unhideAll(),this.cardsMode=t):alert("An error has occurred.");else if(t==this.cardsMode)if("swap"==this.cardsMode){if(this.currentlySelectedAmount==this.selectedCap){var n=this.cards.filter(function(t){return!t.selected&&t.alive});console.log(n),this.$apollo.mutate({mutation:C()(Ct()),variables:{input:{id:this.userId,hand:n.map(function(t){return t.id})}}}).then(function(t){e.cards=e.cards.filter(function(t){return t.selected||!t.alive}),e.unselectAll(),e.hideAll(),e.ownAll(),e.cardsMode="display"}).catch(function(t){console.error(t),alert("An error has occurred.")})}}else if("kill"==this.cardsMode){if(0==this.currentlySelectedAmount)this.cardsMode="display",this.hideAll();else if(this.currentlySelectedAmount==this.selectedCap){for(var o=this.getSelectedCards(),r=0;r<o.length;++r)o[r].alive=!1,o[r].hidden=!1;this.unselectAll(),this.hideAll(),this.cardsMode="display"}}else if("reveal"==this.cardsMode){if(0==this.currentlySelectedAmount)this.cardsMode="display",this.hideAll();else if(this.currentlySelectedAmount==this.selectedCap){o=this.getSelectedCards();console.log("selectedCards"),console.log(o),console.log(o.map(function(t){return t.id})),this.$apollo.mutate({mutation:C()(vt()),variables:{input:{id:this.userId,hand:o.map(function(t){return t.id})}}}).then(function(t){if(console.log(JSON.stringify(t.data.revealCard.player.hand.sort(function(t,e){return t-e}))==JSON.stringify(e.cards.map(function(t){return t.id}).sort(function(t,e){return t-e}))),JSON.stringify(t.data.revealCard.player.hand.sort(function(t,e){return t-e}))!=JSON.stringify(e.cards.map(function(t){return t.id}).sort(function(t,e){return t-e})))for(var n=t.data.revealCard.player.hand.filter(function(t){return e.cards.reduce(function(e,n){return e&&t!=n.id},!0)}),o=e.parseCards(n,{hidden:!0,alive:!0,selected:!1,owned:!0}),r=e.cards.map(function(t,e){return t.selected?e:-1}).filter(function(t){return-1!=t}),a=0;a<r.length;++a){var i=r[a];e.cards.splice(i,1,o[a])}e.unselectAll(),e.hideAll(),e.cardsMode="display"}).catch(function(t){})}}else alert("An error has occurred.")},getSelectedCards:function(){return this.cards.filter(function(t){return t.selected})},doToAll:function(t,e){for(var n=0;n<this.cards.length;++n)this.cards[n][t]=e},unhideAll:function(){this.doToAll("hidden",!1)},hideAll:function(){this.doToAll("hidden",!0)},unselectAll:function(){this.doToAll("selected",!1)},ownAll:function(){this.doToAll("owned",!0)},clickedCard:function(t){var e=this.cards.find(function(e){return e.id==t});if("display"==this.cardsMode)e.hidden=!e.hidden;else if("swap"==this.cardsMode||"kill"==this.cardsMode||"reveal"==this.cardsMode){if(e.selected)return void(e.selected=!1);if(!e.alive)return;if(1==this.selectedCap)return this.unselectAll(),void(e.selected=!0);this.currentlySelectedAmount<this.selectedCap&&(e.selected=!0)}else alert("An error has occurred.")},swapCards:function(){}}},gt=At,It=(n("4f46"),Object(i["a"])(gt,T,q,!1,null,"2f68c8b1",null));It.options.__file="RoomGame.vue";var Mt=It.exports;function $t(){var t=Object(h["a"])(["mutation ($input: RoomActionInput!) {\n          joinRoom(input: $input) {\n            player {\n              id\n            }\n          }\n        }"]);return $t=function(){return t},t}var Ot={components:{RoomLobby:L,RoomGame:Mt},props:["roomId"],data:function(){return{currentRoomComponent:"",userId:""}},created:function(){this.setup()},watch:{$route:function(t,e){this.setup()}},methods:{setup:function(){var t=this;this.$apollo.mutate({mutation:C()($t()),variables:{input:{roomKey:this.roomId}}}).then(function(e){t.userId=e.data.joinRoom.player.id,t.currentRoomComponent="RoomLobby"}).catch(function(e){console.error(e),alert("An error has occurred."),t.$router.push("home")})},changeRoomComponent:function(t){this.currentRoomComponent=t}}},wt=Ot,kt=(n("5ca11"),Object(i["a"])(wt,k,j,!1,null,null,null));kt.options.__file="Room.vue";var jt=kt.exports;o["a"].use(d["a"]);var St=new d["a"]({routes:[{path:"/",name:"home",component:w},{path:"/:roomId",name:"room",component:jt,props:!0}]}),Rt=(n("96cf"),n("1da1"),n("be94")),Gt=n("522d"),Et=n("efe7");o["a"].use(Gt["a"]);var Pt="apollo-token",xt=Object({NODE_ENV:"production",VUE_APP_CLI_UI_URL:"",BASE_URL:"/"}).VUE_APP_GRAPHQL_HTTP||"https://koup-api.herokuapp.com/graphql",Nt={httpEndpoint:xt,wsEndpoint:Object({NODE_ENV:"production",VUE_APP_CLI_UI_URL:"",BASE_URL:"/"}).VUE_APP_GRAPHQL_WS||null,tokenName:Pt,persisting:!1,websocketsOnly:!1,ssr:!1};function Lt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object(Et["createApolloClient"])(Object(Rt["a"])({},Nt,t)),n=e.apolloClient,o=e.wsClient;n.wsClient=o;var r=new Gt["a"]({defaultClient:n,defaultOptions:{$query:{}},errorHandler:function(t){console.log("%cError","background: red; color: white; padding: 2px 4px; border-radius: 3px; font-weight: bold;",t.message)}});return r}o["a"].config.productionTip=!1,new o["a"]({router:St,apolloProvider:Lt(),render:function(t){return t(u)}}).$mount("#app")},"5ca11":function(t,e,n){"use strict";var o=n("aef2"),r=n.n(o);r.a},"64a9":function(t,e,n){},"6b64":function(t,e,n){"use strict";var o=n("2b46"),r=n.n(o);r.a},"846b":function(t,e,n){},"85cd":function(t,e,n){},"915a":function(t,e,n){"use strict";var o=n("e211"),r=n.n(o);r.a},a57a:function(t,e,n){},ab64:function(t,e,n){"use strict";var o=n("85cd"),r=n.n(o);r.a},aef2:function(t,e,n){},b7f6:function(t,e,n){"use strict";var o=n("28b7"),r=n.n(o);r.a},bade:function(t,e,n){},cf79:function(t,e,n){"use strict";var o=n("ff40"),r=n.n(o);r.a},e211:function(t,e,n){},e2ef:function(t,e,n){},eb9f:function(t,e,n){"use strict";var o=n("846b"),r=n.n(o);r.a},ff40:function(t,e,n){}});
//# sourceMappingURL=app.ffcb06c8.js.map